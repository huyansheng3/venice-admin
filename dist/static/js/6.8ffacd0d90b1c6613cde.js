webpackJsonp([6],{OTkb:function(e,t,a){(e.exports=a("FZ+f")(!1)).push([e.i,"\n.edit-container {\n  padding: 15px;\n  width: 100%;\n}\n#editor {\n  min-height: 350px;\n}\n.is-checked {\n  background: #f0f7ff !important;\n}\n",""])},P9GY:function(e,t,a){(e.exports=a("FZ+f")(!1)).push([e.i,"",""])},YdoF:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Xxa5"),l=a.n(r),o=a("exGp"),s=a.n(o),i=a("//Fk"),n=a.n(i),c=a("95YI"),d=a.n(c),u=a("u+Ax"),m=a.n(u),p=a("0xDb"),g=a("TIfe"),f={data:function(){return{fullscreenLoading:!1,dialog:{dialogVisible:!1,addGoodsVisible:!1,dialogImageUrl:""},dateTimePicker:{selectDate:[]},uploadFile:{uploadImageList:[]},Form:{search:{searchParam:{pageIndex:1,pageSize:100},searchResult:[]},ArticleStatus:[{value:"1",label:"开启"},{value:"9",label:"关闭"}]}}},watch:{},components:{VDistpicker:d.a,"d-player":m.a},computed:{},methods:{handleUploadSuccess:function(e,t,a){this.uploadFile.uploadImageList=a},handleUploadRemove:function(e,t){this.uploadFile.uploadImageList=t},handlePictureCardPreview:function(e){this.dialog.dialogImageUrl=e.url,this.dialog.dialogVisible=!0},successUploadFile:function(e,t){var a=this;return new n.a(function(r,l){a.$refs.uploadImages.submit();var o=setInterval(function(){if(e.length===a.uploadFile.uploadImageList.length-t.length)return clearInterval(o),r()},1e3)})},addGoods:function(){var e=this;if(!this.Form.search.selectGoodsData||""==this.Form.search.selectGoodsData)return this.$message.error("请选择要添加的商品");this.Form.search.selectGoodsData.map(function(t){return e.Form.product_list.push(t)}),this.dialog.addGoodsVisible=!1},selectGoodsData:function(e,t){this.Form.search.selectGoodsData=e},searchGoods:function(){var e=this;if(this.Form.keyWords){var t=this.Form.search.searchParam;t.Keywords=this.Form.keyWords,this.fullscreenLoading=!0,this.$store.dispatch("GetSearchGoodsData",t).then(function(t){e.Form.search.searchResult=t.Data,e.Form.search.searchCount=t.total,e.fullscreenLoading=!1})}},editGoodsKill:function(){var e=this;return s()(l.a.mark(function t(){var a,r,o;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.Form.status){t.next=2;break}return t.abrupt("return",e.$message.error("请选择状态"));case 2:if(e.Form.summary){t.next=4;break}return t.abrupt("return",e.$message.error("请填写商品详情"));case 4:if(e.Form.type){t.next=6;break}return t.abrupt("return",e.$message.error("请填写资讯类型"));case 6:if(e.dateTimePicker.selectDate){t.next=8;break}return t.abrupt("return",e.$message.error("请填写开始结束时间"));case 8:if(e.fullscreenLoading=!0,a={Id:e.Form.id,type:e.Form.type,summary:e.Form.summary,AdminToken:Object(g.a)(),content:e.Form.content,product_list:e.Form.product_list,start_date:e.dateTimePicker.selectDate[0],end_date:e.dateTimePicker.selectDate[1],status:e.Form.status},r=window.document.getElementById("uploadImges").getElementsByClassName("el-upload-list__item is-ready"),o=document.getElementById("uploadImges").getElementsByClassName("el-upload-list__item is-success"),!(r.length>0)){t.next=19;break}return t.next=15,e.successUploadFile(r,o);case 15:a.image_url=[],e.uploadFile.uploadImageList.map(function(e,t,r){a.image_url.push({name:e.name,url:e.url.indexOf("blob")>-1?e.response.Data[0].filename:e.url})}),t.next=20;break;case 19:a.image_url=e.uploadFile.uploadImageList;case 20:e.Form.newContent&&(a.content=e.Form.newContent),e.$store.dispatch("EditGoodsCategory",a).then(function(t){e.fullscreenLoading=!1,e.$message.success("修改成功"),e.$store.dispatch("GetGoodsCategoryList",{pageIndex:1,pageSize:100}),setTimeout(function(){e.$router.go(-1)},1e3)},function(t){e.fullscreenLoading=!1});case 23:case"end":return t.stop()}},t,e)}))()},initData:function(){var e=this;return s()(l.a.mark(function t(){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.$route.params.id){t.next=2;break}return t.abrupt("return",e.$message.error("Id有误"));case 2:e.fullscreenLoading=!0,e.$store.dispatch("GetGoodsCategory",{Id:e.$route.params.id}).then(function(t){t.Data.product_list.map(function(e){return e.createTime=Object(p.a)(e.createTime,"{y}-{m}-{d}")}),e.Form.id=t.Data.id,e.Form.type=t.Data.type,e.Form.summary=t.Data.summary,e.dateTimePicker.selectDate=[new Date(t.Data.start_date),new Date(t.Data.end_date)],e.Form.status=t.Data.status,e.Form.product_list=t.Data.product_list,e.Form.content=t.Data.content,e.Form.product_list=t.Data.product_list,e.uploadFile.uploadImageList=t.Data.image_url,e.fullscreenLoading=!1},function(e){});case 4:case"end":return t.stop()}},t,e)}))()}},beforeDestroy:function(){},mounted:function(){this.initData()}},b={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"edit-container"},[a("el-form",{ref:"ruleForm",staticClass:"card-box admin-form",attrs:{model:e.Form,"label-position":"left"}},[a("el-form-item",{attrs:{label:"文章Id",prop:"id","label-width":"120px"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.Form.id,callback:function(t){e.$set(e.Form,"id",t)},expression:"Form.id"}})],1),e._v(" "),a("el-form-item",{attrs:{rules:[{required:!0,message:"简介不能为空"}],label:"简介",prop:"summary","label-width":"120px"}},[a("el-input",{model:{value:e.Form.summary,callback:function(t){e.$set(e.Form,"summary",t)},expression:"Form.summary"}})],1),e._v(" "),a("el-form-item",{attrs:{rules:[{required:!0,message:"资讯类型不能为空"}],label:"资讯类型",prop:"type","label-width":"120px"}},[a("el-input",{model:{value:e.Form.type,callback:function(t){e.$set(e.Form,"type",t)},expression:"Form.type"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"开始结束时间","label-width":"120px"}},[a("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",align:"right"},model:{value:e.dateTimePicker.selectDate,callback:function(t){e.$set(e.dateTimePicker,"selectDate",t)},expression:"dateTimePicker.selectDate"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"状态",prop:"status","label-width":"120px"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.Form.status,callback:function(t){e.$set(e.Form,"status",t)},expression:"Form.status"}},e._l(e.Form.ArticleStatus,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}},[a("span",{staticStyle:{float:"left"}},[e._v(e._s(t.label))]),e._v(" "),a("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(t.value))])])}))],1),e._v(" "),a("el-form-item",{attrs:{label:"内容",prop:"content","label-width":"120px"}},[a("vue-html5-editor",{staticStyle:{margin:"30px 0"},attrs:{content:e.Form.content,"auto-height":!0},on:{change:function(t){return e.Form.newContent=t}}})],1),e._v(" "),a("el-form-item",{attrs:{id:"uploadImges",label:"封面",prop:"avatar","label-width":"120px"}},[a("el-upload",{ref:"uploadImages",attrs:{action:"http://awei.fun:3333/Unit/uploadfile","list-type":"picture-card",multiple:!0,limit:5,"file-list":e.uploadFile.uploadImageList,autoUpload:!1,"on-remove":e.handleUploadRemove,onPreview:e.handlePictureCardPreview,onSuccess:e.handleUploadSuccess,onExceed:function(){e.$message.error("图片不能超过五张")}}},[a("i",{staticClass:"el-icon-plus"})])],1),e._v(" "),a("el-form-item",{attrs:{label:"商品列表","label-width":"120px"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{"highlight-current-row":"","header-align":"center",align:"center",data:e.Form.product_list,border:""}},[a("el-table-column",{attrs:{prop:"image_url",label:"商品图片",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("img",{staticStyle:{width:"80px",height:"80px",cursor:"pointer"},attrs:{src:t.row.image_url[0].url},on:{click:function(){e.dialog.dialogVisible=!0,e.dialog.dialogImageUrl=t.row.image_url[0].url}}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"productName",label:"商品名称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"productNo",label:"商品编号"}}),e._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"categoryId",label:"所属分类",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"price",label:"商品单价",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"stocks",label:"商品库存",sortable:""}})],1),e._v(" "),a("el-button",{staticStyle:{width:"100%"},attrs:{type:"default"},on:{click:function(){return e.dialog.addGoodsVisible=!0}}},[e._v("添加商品")])],1),e._v(" "),a("el-form-item",[a("el-button",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:e.editGoodsKill}},[e._v("修改")])],1)],1),e._v(" "),a("el-dialog",{attrs:{visible:e.dialog.dialogVisible,size:"tiny"},on:{"update:visible":function(t){e.$set(e.dialog,"dialogVisible",t)}}},[a("img",{attrs:{width:"100%",src:e.dialog.dialogImageUrl,alt:""}})]),e._v(" "),a("el-dialog",{attrs:{title:"添加商品",visible:e.dialog.addGoodsVisible},on:{"update:visible":function(t){e.$set(e.dialog,"addGoodsVisible",t)}}},[a("div",{staticClass:"search-container",on:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.searchGoods(t)}}},[a("el-input",{staticStyle:{width:"85%"},attrs:{placeholder:"输入要搜索的产品关键字、编号、店家编号等"},model:{value:e.Form.keyWords,callback:function(t){e.$set(e.Form,"keyWords",t)},expression:"Form.keyWords"}}),e._v(" "),a("el-button",{attrs:{type:"default"},on:{click:e.searchGoods}},[e._v("搜索")])],1),e._v(" "),a("div",{staticClass:"goods-container",staticStyle:{padding:"15px 0"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{"empty-text":"暂无数据","highlight-current-row":"","header-align":"center",align:"center",data:e.Form.search.searchResult,border:""},on:{select:e.selectGoodsData}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{prop:"image_url",label:"商品图片",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("img",{staticStyle:{width:"80px",height:"80px",cursor:"pointer"},attrs:{src:t.row.image_url[0].url},on:{click:function(){e.dialog.dialogVisible=!0,e.dialog.dialogImageUrl=t.row.image_url[0].url}}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"productName",label:"商品名称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"productNo",label:"商品编号"}}),e._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"categoryId",label:"所属分类",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"price",label:"商品单价",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"stocks",label:"商品库存",sortable:""}})],1)],1),e._v(" "),a("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:e.addGoods}},[e._v("添加")])],1)],1)},staticRenderFns:[]};var h=a("VU/8")(f,b,!1,function(e){a("pj2x"),a("bq9S")},"data-v-d12a0aac",null);t.default=h.exports},bq9S:function(e,t,a){var r=a("P9GY");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a("rjj0")("4ab64d75",r,!0)},pj2x:function(e,t,a){var r=a("OTkb");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a("rjj0")("7e25a193",r,!0)}});